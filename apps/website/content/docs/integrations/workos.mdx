---
title: "WorkOS"
metadataTitle: "Usage with WorkOS | xmcp Documentation"
publishedAt: "2025-07-06"
summary: "Add secure authentication to your MCP server using WorkOS AuthKit"
description: "Add secure authentication to your MCP server using WorkOS AuthKit"
---

## Overview

The WorkOS plugin provides authentication for your xmcp server using [WorkOS AuthKit](https://workos.com/authkit), a hosted OAuth authorization server with enterprise SSO support.

<Callout variant="info">
  AuthKit handles all authentication - no database required on your end.
</Callout>

## Installation

Install the WorkOS plugin:

```bash
npm install @xmcp-dev/workos
```

## WorkOS Setup

Before integrating the plugin, configure your WorkOS account:

1. Create a [WorkOS account](https://workos.com) if you don't have one
2. Navigate to your dashboard and note your:
   - **API Key** (starts with `sk_`)
   - **Client ID** (starts with `client_`)
   - **AuthKit domain** (e.g., `yourcompany.authkit.app`)
3. Enable **Client ID Metadata Document** in Connect â†’ Configuration

<Callout variant="warning" icon="alertTriangle" title="Required">
  The Client ID Metadata Document must be enabled for MCP clients to discover your authorization server.
</Callout>

## Environment Variables

Configure the following environment variables in your `.env` file:

```bash
# WorkOS credentials
WORKOS_API_KEY=sk_test_...
WORKOS_CLIENT_ID=client_...
WORKOS_AUTHKIT_DOMAIN=yourcompany.authkit.app

# App configuration
BASE_URL=http://127.0.0.1:3001
```

## Configuration

Create a `middleware.ts` file in your xmcp app root directory:

```typescript title="src/middleware.ts"
import { workosProvider } from "@xmcp-dev/workos";

export default workosProvider({
  apiKey: process.env.WORKOS_API_KEY!,
  clientId: process.env.WORKOS_CLIENT_ID!,
  authkitDomain: process.env.WORKOS_AUTHKIT_DOMAIN!,
  baseURL: process.env.BASE_URL || "http://127.0.0.1:3001",
});
```

### Configuration Options

- **`apiKey`** - WorkOS API key from your dashboard
- **`clientId`** - WorkOS client ID for OAuth
- **`authkitDomain`** - Your AuthKit domain (e.g., `yourcompany.authkit.app`)
- **`baseURL`** - Base URL of your app for OAuth callbacks

## Usage in Tools

Access the authenticated user session in your xmcp tools using `getWorkOSSession`:

```typescript title="src/tools/greet.ts"
import { getWorkOSSession } from "@xmcp-dev/workos";

export default async function greet({ name }: { name: string }) {
  const session = await getWorkOSSession();

  return `Hello, ${name}! Your email is ${session.user.email}`;
}
```

<Callout variant="warning">
  `getWorkOSSession` will throw an error if called outside of a
  `workosProvider` middleware context.
</Callout>

The session includes user profile data fetched from WorkOS:

- `session.user.id` - Unique user identifier
- `session.user.email` - User's email address
- `session.user.firstName` / `lastName` - User's name
- `session.organizationId` - Organization ID (if applicable)

## Next Steps

After authentication is configured, users will be redirected to WorkOS AuthKit's hosted UI when establishing a connection to your MCP server.
